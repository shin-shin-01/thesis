%#! platex thesis.tex

%======================================================================
\chapter{評価}
\label{cha:eval}

本章では，\ref{sec:collection}節で39名から収集した15911語を用いて行った評価の概要と，その結果を示す．

\section{各値の設定}
\label{sec:thres}
\textbf{表~\ref{tab:augment}}にSRP手法におけるデータ拡張時の各値を示し，\textbf{表~\ref{tab:augment_ratio}}にRatio手法におけるデータ拡張時の各値を示す．また\textbf{表~\ref{tab:augment_pattern}}にデータ拡張の種類・拡張倍率の組み合わせパターンを示す．データ拡張を使用したときは拡張後のデータ数を元データの100倍に統一している．
回転でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 1.5$となるような乱数の角度をストロークごとに生成し，ストロークの回転を施した．平行移動でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 0.0001$となるような乱数の$dx$と$dy$を各ストロークごとに生成し，ストロークの平行移動を施した．
文字の比率変更のデータ拡張では，$x$座標・$y$座標どちらを基準に比率変更を行うかを\ref{ratio}項をもとに，$x:y = 1:2$の割合でランダムに決定している．また比率の割合を拡張回数が１回の時に$r = 0.00$とし回数を重ねるごとに$r = 0.02$ずつ増加させて，文字の拡張比率の変更を施している．ただし拡張回数が100回の時は，比率の割合を$r = 0.002$ずつ増加させている．
先行研究ではストロークの平行移動，回転をそれぞれ10回ずつ行っている．本論文では，ストロークの平行移動，ストロークの回転，文字の比率変更を拡張回数を変更し，それぞれを組み合わせて実験を行なっている．

\begin{table}[bt]
 \centering
 \caption{SRP手法におけるデータ拡張時の値}
 \label{tab:augment}
 \begin{tabular}{c|cc}\Hline
   データ拡張の種類 & $\mu$ & $\sigma^2$\\
   \hline
   ストロークの回転移動 & $0$ & $1.5$\\
   ストロークの平行移動 & $0$ & $1.0\times10^{-4}$\\
 \Hline
 \end{tabular}
\end{table}

\begin{table}[bt]
 \centering
 \caption{Ratio手法におけるデータ拡張時の値}
 \label{tab:augment_ratio}
 \begin{tabular}{c|cc}\Hline
   データ拡張倍数 & $x:yの割合$ & $拡張比率(拡張回数n)$\\
   \hline
	10倍以下 & $1:2$ & $0.02\times(n-1) $\\
	100倍 & $1:2$ & $0.002\times(n-1) $\\
 \Hline
 \end{tabular}
\end{table}


\begin{table}[bt]
 \centering
 \caption{データ拡張の種類・拡張倍率の組み合わせ}
 \label{tab:augment_pattern}
 \begin{tabular}{ccc}\Hline
   平行移動(PS)の倍率 & 回転(SR)の倍率 & 文字の比率拡張の倍率\\
   \hline
   100.0  & 不使用 & 不使用\\
   不使用 & 100.0 & 不使用\\
   不使用 & 不使用 &100.0\\
   10.0     & 10.0 & 不使用\\
   10.0     & 不使用 & 10.0\\
   不使用 & 10.0 & 10.0\\
   5.0        & 5.0 & 4.0\\
   \hline
   
 \end{tabular}
\end{table}

%----------------------------------------------------------------------
\section{評価方法}
\label{sec:ev_method}
データ提供者39名の中から，データ提供が途中で止まっていた12名を除いた27名のうちから3名をランダムで抜き出し，その3名のデータをテスト用のデータとし，残りの24名と12名のデータを学習用のデータとした．その後学習用データに対してデータ拡張を行い，検証用データと$9:1$の割合で分けた後機械学習を行った．学習用データにはテストに用いられるデータ提供者3名のデータは一語も含まれていない．
この過程を10回繰り返し，各回の精度の平均値，中央値などを求める．以上の方法で\textbf{表~\ref{tab:augment_pattern}}に示したパターンでのそれぞれの精度を求め，先行研究\cite{takahashi}の結果と比較することで本研究のデータ拡張手法の有効性を測る．
\section{評価結果}
\label{sec:ev_ result}
 \textbf{表~\ref{tab:result}}に先行研究および本研究での評価結果を示す．データ拡張を行った際はエポック数を5，ミニバッチサイズを512に設定し，データ拡張を行わなかった場合はエポック数を100，ミニバッチサイズを64に設定した．エポック毎に異なるミニバッチを作成するため，エポック毎に学習データをシャッフルした．過学習を防ぐため，どちらにもkerasのEarlyStopping\cite{earlystopping}を用いた．最適化関数にはAdam\cite{kingma14:adam}を用い，学習率は$0.001$とした．

 結果として，データ拡張を行わなかった場合の平均精度が73.4\%，SRP手法のみでデータを100倍に拡張した場合の平均精度は89.5\%であったのに対し，SRP手法と新手法Ratio手法を組み合わせて拡張した場合の平均精度は93.0\%であった．先行研究\cite{takahashi}において，データ拡張を行わなかった場合，SRP手法のみでデータ拡張を行った場合でも最大精度は比較的高いが，最小精度が低かった．
 
ストロークの回転手法（SR手法）のみを用いてデータを100倍にした場合では，最小精度が大きく減少した．これは，回転手法でのデータ拡張を100回も行うと同じようなデータが増えてしまい，過学習が起きてしまうことが原因であると考えられる．データ拡張におけるパラメータは文字の形が変わらないように設定している．文字においてそれぞれのストロークの角度は，ストロークの長さや位置よりも重要な要素であり，回転手法において文字の形を変えないようにするためには回転拡張時のパラメータがとる値の範囲を狭める必要がある．そのため回転手法のみでデータ拡張を行うと，拡張の度にランダムに設定されたパラメータの値によっては似たようなデータが増えてしまい過学習を起こしてしまう．
ストロークの平行移動（PS手法），文字の比率変更（Ratio手法）では文字のストロークと点の平行移動を行っており拡張方法が類似しているため，同じような精度を得た．最小精度が高い要因として，どちらの手法も拡張後に文字の形を大きく変えてしまうことがなく，文字の形を残したままデータを多様化することができたからである．

それぞれの拡張手法を2つ組み合わせて拡張を行った場合はいずれも最小精度が低かった．先行研究\cite{takahashi}のSRP手法でデータ拡張を行った場合には，回転手法で同じようなデータを増やしてしまい，平行移動による手法のみの場合に比べてデータが多様化されなかったことが，最小精度を低くした原因だと考えられる．新手法のRatio手法を用いた場合では，SRP手法に比べて最小精度を上げることができている．これはRatio手法が事前に変更比率を定める手法であり，Ratio手法を用いて拡張されたデータはそれぞれが必ず一定の割合で変化しており，少ない倍率でもRatio手法を組み合わせることによってデータが多様化するからである．しかしPS手法とRatio手法を組み合わせた場合では，それぞれを単独で100倍に拡張した場合より，平均精度および最小精度が低くなっている．これは，PS手法とRatio手法が似た手法でありRatio手法で拡張されたデータにPS手法のみで拡張を施すと，同じようなデータが増えてしまったことが原因だと考えれらる．

SR手法及びPS手法を5回ずつ用いて，Ratio手法を4回適用し100倍に拡張した場合では，平均精度及び最小精度を大きく向上させることができている．SR手法を100倍で拡張した際はSR手法のパラメータの範囲が狭いために同じようなパラメータを選択してしまっていたが，5倍の拡張では同じパラメータを選択する場合が少なかったことで，PS手法及びRatio手法で拡張したデータをさらに多様化することができたからである．

上記結果よりRatio手法を組み合わせてデータ拡張を行った場合，Ratio手法での拡張回数が数ない場合でもデータの多様化を行うことができるため，Ratio手法を取り入れない場合の拡張方法に比べて最小精度が向上した．Ratio手法はデータの多様化に対する有効性があるといえる．
 
  \begin{table}[bt]
  \centering
  \caption{評価結果}
  \label{tab:result}
  \begin{tabular}{c|cccc}\Hline
    評価対象 & 拡張倍数 & 平均精度[\%] & 最大精度[\%] &  最小精度[\%] \\
    \hline
    データ拡張なし& \texttt{$1.0$倍} & \texttt{$73.4$} & \texttt{$90.8$} & \texttt{$19.0$}\\
    PS($100$回)& \texttt{$100.0$倍} & \texttt{$91.3$} & \texttt{$93.9$} & \texttt{$87.8$}\\
    SR($100$回)& \texttt{$100.0$倍} & \texttt{$83.8$} & \texttt{$95.6$} & \texttt{$3.33$}\\
    Ratio($100$回)& \texttt{$100.0$倍} & \texttt{$91.4$} & \texttt{$95.7$} & \texttt{$87.5$}\\
    (従来手法) SR($10$回)PS($10$回)& \texttt{$100.0$倍} & \texttt{$89.5$} & \texttt{$95.4$} & \texttt{$68.0$}\\
    SR($10$回)Ratio($10$回)& \texttt{$100.0$倍} & \texttt{$90.0$} & \texttt{$95.9$} & \texttt{$77.4$}\\
    PS($10$回)Ratio($10$回)& \texttt{$100.0$倍} & \texttt{$88.8$} & \texttt{$94.2$} & \texttt{$78.0$}\\
    SR($5$回)PS($5$回)Ratio($4$回)& \texttt{$100.0$倍} & \texttt{$93.0$} & \texttt{$94.5$} & \texttt{$92.1$}\\
  \Hline
  \end{tabular}
 \end{table}


% 以下はRefTeX用
%%% Local Variables:
%%% mode: yatex
%%% TeX-master: "thesis"
%%% End:
