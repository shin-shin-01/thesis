%#! platex thesis.tex

%======================================================================
\chapter{評価}
\label{cha:eval}

本章では，\ref{sec:collection}節で39名から収集した15911語を用いて行った評価の概要と，その結果を示す．

\section{高橋さんの評価}
元データに対し，データ拡張なし・データ拡張あり(100倍)の２パターンで精度を比較している
\section{風の評価構想}
[やったこと]SRPとRatioで125倍，SRとRatioで100倍，PSとRatioで100倍で拡張
[やること]単純に高橋さんとの精度の比較を行う．さらに関連研究（中国語）の元データを1/100にしデータを100倍して，データ数を同じにした．という条件のもとで拡張の有効性を検証する．

\section{各値の設定}
\label{sec:thres}
データ前処理における2つの閾値は，それぞれ$T_{cos} = 0.99$，$T_{dist} = 0.005*max(H, W)$とした．ここで$H$はデータ提供者がデータを入力する場所の縦幅，$W$は横幅を示している．

\textbf{表~\ref{tab:augment}}にデータ拡張時の各値を示す．
回転でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 25$となるような乱数の角度をストロークごとに生成し，ストロークの回転を施した．この処理を1つの単語に対して10回行った．平行移動でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 0.0001$となるような乱数の$dx$と$dy$を各ストロークごとに生成し，ストロークの平行移動を施した．この処理を，回転でのデータ拡張を行った単語に対してそれぞれ10回行った．

\begin{table}[bt]
 \centering
 \caption{データ拡張時の値}
 \label{tab:augment}
 \begin{tabular}{c|cc}\Hline
   データ拡張の種類 & $\mu$ & $\sigma^2$\\
   \hline
   ストロークの回転移動 & $0$ & $25$\\
   ストロークの平行移動 & $0$ & $1.0\times10^{-4}$\\
 \Hline
 \end{tabular}
\end{table}

ガウス分布のパラメータは，それぞれ文字の形を崩さないと筆者が判断できるもののうち最大の値を設定した．SRP手法でのデータ拡張を行うことで，データ量を元の量の100倍とした．

%----------------------------------------------------------------------
\section{評価方法}
\label{sec:ev_method}
データ提供者39名の中から，データ提供が途中で止まっていた12名を除いた27名のうちから3名をランダムで抜き出し，その3名のデータをテスト用のデータとした．残りの24名と12名のデータを学習用のデータとした．その後学習用データに対してデータ拡張を行い，検証用データと$9:1$の割合で分けた後機械学習を行った．学習用データにはテストに用いられるデータ提供者3名のデータは一語も含まれていない．
この過程を10回繰り返し，各回の精度の平均値，中央値などを求めることで，本研究の手書き医療用語認識の有効性を測る．さらにデータ拡張を行った場合のテスト結果と，行わなかった場合のテスト結果を比較することで，SRP手法を用いたデータ拡張の有効性を測る．

\section{評価結果}
\label{sec:ev_ result}
 \textbf{表~\ref{tab:result}}に評価の結果を示す．データ拡張を行った際はエポック数を5，ミニバッチサイズを512に設定し，データ拡張を行わなかった場合はエポック数を100，ミニバッチサイズを64に設定した．エポック毎に異なるミニバッチを作成するため，エポック毎に学習データをシャッフルした．過学習を防ぐため，どちらにもkerasのEarlyStopping\cite{earlystopping}を用いた．最適化関数にはAdam\cite{kingma14:adam}を用い，学習率は$0.001$とした．

 結果として，データ拡張を行わなかった場合の平均精度が73.4\%であったのに対し，データ拡張を行った場合の平均精度は89.5\%であった．データ拡張を行わなかった場合でも比較的高い精度が出ていたが，テストデータの取り方によるばらつきが非常に大きかった．一方でデータ拡張を行った場合は全体として精度が安定していた．分散，標準誤差もデータ拡張を行った場合の方が小さかった．データ拡張を行わなかった場合の方が過学習を起こす回数が多かったことが原因としてあげられる．過学習を起こす回数に違いが出た理由としては，同じデータをエポック数を増やして何度も学習したためデータの多様性が低くなったことがあげられる．

 \begin{table}[bt]
  \centering
  \caption{評価結果}
  \label{tab:result}
  \begin{tabular}{c|cccc}\Hline
    評価対象 & 精度[\%]（平均値）& 精度[\%]（中央値）& 分散 & 標準誤差\\
    \hline
    データ拡張なし & \texttt{$73.4$} & \texttt{$83.7$} & \texttt{$5.3\times10^{-2}$} & \texttt{$2.3\times10^{-1}$}\\
    データ拡張あり & \texttt{$89.5$} & \texttt{$91.4$} & \texttt{$5.7\times10^{-3}$} & \texttt{$7.5\times10^{-2}$}\\
  \Hline
  \end{tabular}
 \end{table}


% 以下はRefTeX用
%%% Local Variables:
%%% mode: yatex
%%% TeX-master: "thesis"
%%% End:
