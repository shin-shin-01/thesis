%#! platex thesis.tex

%======================================================================
\chapter{評価}
\label{cha:eval}

本章では，\ref{sec:collection}節で39名から収集した15911語を用いて行った評価の概要と，その結果を示す．

\section{各値の設定}
\label{sec:thres}
データ前処理における2つの閾値は，それぞれ$T_{cos} = 0.99$，$T_{dist} = 0.005*max(H, W)$とした．ここで$H$はデータ提供者がデータを入力する場所の縦幅，$W$は横幅を示している．

\textbf{表~\ref{tab:augment}}にSRP手法におけるデータ拡張時の各値を示し，\textbf{表~\ref{tab:augment_ratio}}にRatio手法におけるデータ拡張時の各値を示す．各パラメータの値は，学習を行い，実際に最も精度が高かったものを使用している．
回転でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 1.5$となるような乱数の角度をストロークごとに生成し，ストロークの回転を施した．平行移動でのデータ拡張では，ガウス分布を用いて平均$\mu = 0$，分散$\sigma^2 = 0.0001$となるような乱数の$dx$と$dy$を各ストロークごとに生成し，ストロークの平行移動を施した．
文字の比率変更のデータ拡張では，$x$座標・$y$座標どちらを基準に比率変更を行うかを$x:y$を$1:2$の割合でランダムに決定している．また比率の割合を拡張回数が１回の時に$0.00$とし回数を重ねるごとに$0.02$ずつ増加させて，文字の拡張比率の変更を施している．
先行研究ではストロークの平行移動，回転をそれぞれ10回ずつ行っている．本研究では，ストロークの平行移動，ストロークの回転，文字の比率変更を拡張回数を変更し，それぞれを組み合わせて実験を行なっている．\textbf{表~\ref{tab:augment_pattern}}にデータ拡張の種類・拡張倍率の組み合わせパターンを示す．


\begin{table}[bt]
 \centering
 \caption{SRP手法におけるデータ拡張時の値}
 \label{tab:augment}
 \begin{tabular}{c|cc}\Hline
   データ拡張の種類 & $\mu$ & $\sigma^2$\\
   \hline
   ストロークの回転移動 & $0$ & $25$\\
   ストロークの平行移動 & $0$ & $1.0\times10^{-4}$\\
 \Hline
 \end{tabular}
\end{table}

\begin{table}[bt]
 \centering
 \caption{Ratio手法におけるデータ拡張時の値}
 \label{tab:augment_ratio}
 \begin{tabular}{c|cc}\Hline
   データ拡張の種類 & $x:yの割合$ & $拡張比率$\\
   \hline
   文字の比率拡張(拡張倍率$n$) & $1:2$ & $0.02\times(n-1)$\\
 \Hline
 \end{tabular}
\end{table}


\begin{table}[bt]
 \centering
 \caption{データ拡張の種類・拡張倍率の組み合わせ}
 \label{tab:augment_pattern}
 \begin{tabular}{c|cccc}\Hline
   データの拡張倍率 & 平行移動(PS)の倍率 & 回転(SR)の倍率 & 文字の比率拡張の倍率\\
   \hline
   $100.0$　& $10.0$ & $10.0$ & 不使用\\
   $100.0$　& $10.0$ & 不使用 & $10.0$\\
   $100.0$　& 不使用 & $10.0$ & $10.0$\\
   $125.0$　& $5.0$ & $5.0$ & $5.0$\\


 \Hline
 \end{tabular}
\end{table}

%----------------------------------------------------------------------
\section{評価方法}
\label{sec:ev_method}
データ提供者39名の中から，データ提供が途中で止まっていた12名を除いた27名のうちから3名をランダムで抜き出し，その3名のデータをテスト用のデータとし，残りの24名と12名のデータを学習用のデータとした．その後学習用データに対してデータ拡張を行い，検証用データと$9:1$の割合で分けた後機械学習を行った．学習用データにはテストに用いられるデータ提供者3名のデータは一語も含まれていない．
この過程を10回繰り返し，各回の精度の平均値，中央値などを求める．以上の方法で\textbf{表~\ref{tab:augment_pattern}}に示したパターンでのそれぞれの精度を求め，先行研究の結果と比較することで本研究のデータ拡張手法の有効性を測る．
\section{評価結果}
\label{sec:ev_ result}
 \textbf{表~\ref{tab:result}}に先行研究および本研究での評価結果を示す．データ拡張を行った際はエポック数を5，ミニバッチサイズを512に設定し，データ拡張を行わなかった場合はエポック数を100，ミニバッチサイズを64に設定した．エポック毎に異なるミニバッチを作成するため，エポック毎に学習データをシャッフルした．過学習を防ぐため，どちらにもkerasのEarlyStopping\cite{earlystopping}を用いた．最適化関数にはAdam\cite{kingma14:adam}を用い，学習率は$0.001$とした．

 結果として，データ拡張を行わなかった場合の平均精度が73.4\%，SRP手法のみでデータを100倍に拡張した場合の平均精度は89.5\%であったのに対し，SRP手法と新手法Ratio手法を組み合わせて拡張した場合の平均精度は93.0\%であった．データ拡張を行わなかった場合，SRP手法のみでデータ拡張を行った場合でも，最大精度は比較的高いが，最小精度が低く，テストデータの取り方によるばらつきが大きかった．一方で，Ratio手法を組み合わせてデータ拡張を行った場合は最小精度が向上した．Ratio手法は，データの多様化に対する有効性があるといえる．
 
  \begin{table}[bt]
  \centering
  \caption{評価結果}
  \label{tab:result}
  \begin{tabular}{c|cccc}\Hline
    評価対象 & データ拡張倍数 & 精度[\%]（平均値）& 精度[\%]（最大値）&  精度[\%]（最小値）\\
    \hline
    データ拡張なし& \texttt{$1.0$倍} & \texttt{$73.4$} & \texttt{$90.8$} & \texttt{$19.0$}\\
    SR($10$回)PS($10$回)& \texttt{$100.0$倍} & \texttt{$89.5$} & \texttt{$95.4$} & \texttt{$68.0$}\\
    SR($10$回)Ratio($10$回)& \texttt{$100.0$倍} & \texttt{$90.0$} & \texttt{$95.9$} & \texttt{$77.4$}\\
    PS($10$回)Ratio($10$回)& \texttt{$100.0$倍} & \texttt{$88.8$} & \texttt{$94.2$} & \texttt{$78.0$}\\
    SR($5$回)PS($5$回)Ratio($5$回)& \texttt{$125.0$倍} & \texttt{$93.0$} & \texttt{$95.0$} & \texttt{$90.4$}\\
  \Hline
  \end{tabular}
 \end{table}


% 以下はRefTeX用
%%% Local Variables:
%%% mode: yatex
%%% TeX-master: "thesis"
%%% End:
